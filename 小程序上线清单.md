# 小程序上线清单

## 📱 小程序修改清单

### 修改的文件
- ✅ `cwlsuniapp/packageA/goods/detail.vue`

### 修改内容
1. scene 参数解析优化（添加 `?` 前缀）
2. 支持 `id` 参数解析
3. 日期格式转换（`20260212` → `2026-02-12`）
4. 日期容错处理（自动添加不存在的日期）
5. 分类自动切换
6. 详细的调试日志（可选：上线前删除）

---

## 🚀 上传步骤

### 1. 清理调试日志（可选）

如果不想保留调试日志，可以删除所有 `console.log`：

**删除范围：**
- `onLoad` 方法中的日志（约 20 行）
- `getDateList` 方法中的日志（约 15 行）

**或者保留：** 调试日志不影响功能，只会在开发者工具中显示

---

### 2. 微信开发者工具上传

1. **打开项目**
   - 路径：`/Users/peakom/worko/kaichengbugong/cwlsuniapp`

2. **编译检查**
   - 点击"编译"
   - 确认无报错

3. **上传代码**
   - 点击右上角"上传"
   - **版本号：** v1.6.0
   - **备注：** 修复扫码参数解析，支持自动定位日期和分类

4. **提交审核**
   - 登录微信公众平台
   - 进入"版本管理"
   - 提交审核

5. **审核通过后发布**

---

### 3. 后台切换环境

**审核通过并发布后：**

1. 登录后台
2. 进入商品编辑页面
3. 生成小程序码时：
   - **环境选择：正式版** ⚠️
4. 之后生成的小程序码所有用户都能扫

---

## 📊 完整测试用例

### 测试用例 1：有数据的日期

**后台生成：**
- 商品ID：39
- 日期：2026-02-05
- 分类：生产全程回放（type=0）
- 环境：正式版

**预期效果：**
- ✅ 商品信息显示
- ✅ 日期定位到 2026-02-05
- ✅ 分类切换到"生产全程回放"
- ✅ 视频列表正常显示

---

### 测试用例 2：无数据的日期

**后台生成：**
- 商品ID：39
- 日期：2026-02-02
- 分类：精彩瞬间（type=1）
- 环境：正式版

**预期效果：**
- ✅ 商品信息显示
- ✅ 日期列表出现 2026-02-02
- ✅ 自动选中该日期
- ✅ 分类切换到"精彩瞬间"
- ✅ 视频列表为空（显示空状态提示）

---

### 测试用例 3：不同分类

**分类对应关系：**
- type=0 → 生产全程回放
- type=1 → 精彩瞬间
- type=2 → 多视角回放
- type=3 → 配料回放

**测试：** 分别测试 4 个分类是否都能正确切换

---

### 测试用例 4：不同商品

**测试：** 使用不同的商品ID生成二维码，验证是否都能正常显示

---

## 🔒 后台部署状态

### 已部署文件
- ✅ `kcbg/application/admin/view/shop/goods/edit.html`
- ✅ `kcbg/application/admin/controller/shop/Ajax.php`
- ✅ 服务器缓存已清理

### 功能特性
- ✅ 环境选择（正式版/体验版/开发版）
- ✅ 调试路径显示
- ✅ 一键复制功能
- ✅ scene 参数优化（26字符）

---

## 📄 相关文档

- `小程序码扫码定位功能-最终版.md` - 完整技术文档
- `小程序体验版测试指南.md` - 体验版测试流程
- `微信开发者工具调试指南.md` - 开发者工具调试方法

---

## ⚠️ 注意事项

### 1. scene 参数长度
- 限制：32 个可见字符
- 当前：26 字符
- 余量：6 字符
- **如果商品ID超过2位数，注意检查总长度**

### 2. 日期格式
- 后台生成：`20260212`（8位数字）
- 小程序显示：`2026-02-12`（带横杠）
- 自动转换，无需手动处理

### 3. 环境选择
- **测试阶段：** 选择"体验版"
- **正式上线：** 选择"正式版"
- 不要混淆！

---

## ✅ 上线检查清单

上线前确认：
- [ ] 小程序代码已上传
- [ ] 已提交审核
- [ ] 审核通过
- [ ] 已发布正式版
- [ ] 后台环境改为"正式版"
- [ ] 生成测试小程序码验证
- [ ] 真机扫码测试通过
- [ ] 不同日期测试通过
- [ ] 不同分类测试通过
- [ ] 无数据日期测试通过

---

**完成以上步骤后，功能即可正式上线！** 🎉
